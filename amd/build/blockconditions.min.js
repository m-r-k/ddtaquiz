define(["jquery"],function(a){var b={panel:null,container:null,index:0,addcondition:function(b){b.preventDefault(),b.stopImmediatePropagation(),this.panel.hide();var c=a(".pointsconditioncontainer").find(".conditionpart").clone(!0);this.index++,c.find(".conditionpoints").attr("name","conditionparts[newparts"+this.index+"][points]"),c.find(".conditiontype").attr("name","conditionparts[newparts"+this.index+"][type]"),c.find(".conditionquestion").attr("name","conditionparts[newparts"+this.index+"][question]"),c.appendTo(".conditionpartslist")},prepare_chooser:function(){if(!this.panel){var b={bodyContent:a("div.addcondition div.chooserdialogue").html(),headerContent:a("div.addcondition div.chooserheader").html(),width:"540px",draggable:!0,visible:!1,zindex:100,modal:!0,shim:!0,closeButtonTitle:"Close",focusOnPreviousTargetAfterHide:!0,render:!1};this.panel=new M.core.dialogue(b),this.panel.hide(),this.panel.render(),this.container=this.panel.get("boundingBox").one(".choosercontainer"),this.panel.get("boundingBox").addClass("chooserdialogue")}},display_chooserdialogue:function(a){this.prepare_chooser(),a.preventDefault(),this.container.one("form").on("submit",function(a){this.addcondition(a)},this),this.panel.show(a),this.panel.centerDialogue()}};return{init:function(){a(".addblockcondition").click(function(a){b.display_chooserdialogue(a)}),a(".conditionpartdelete").click(function(b){b.preventDefault(),b.stopImmediatePropagation(),a(this).parents(".conditionpart").remove()})}}});